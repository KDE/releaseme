#!/bin/bash

LANG=en_US.UTF-8
LANGUAGE=en
LC_ALL=en_US.UTF-8

VERSION=5.0.95

# start off with all of kde/workspace
./tarme.rb --origin stable --version $VERSION kde/workspace/
cat release_data > $VERSION-release-data

#not in this release
rm kwindowsaddons* -rf
sed -i '/kwindowsaddons/d' $VERSION-release-data

# oxygen-fonts gets a different version
rm oxygen-fonts* -r
sed -i '/oxygen-fonts/d' $VERSION-release-data
./tarme.rb --origin stable --version $VERSION oxygen-fonts
cat release_data >> $VERSION-release-data

#frameworks branch set in projects.kde.org
./tarme.rb --origin stable --version $VERSION baloo
cat release_data >> $VERSION-release-data

#frameworks branch set in projects.kde.org
./tarme.rb --origin stable --version $VERSION kfilemetadata
cat release_data >> $VERSION-release-data

./tarme.rb --origin stable --version $VERSION libkscreen
cat release_data >> $VERSION-release-data

./tarme.rb --origin stable --version $VERSION libnm-qt
cat release_data >> $VERSION-release-data

./tarme.rb --origin stable --version $VERSION libmm-qt
cat release_data >> $VERSION-release-data

svn export svn+ssh://svn@svn.kde.org/home/kde/trunk/KDE/plasma-workspace-wallpapers/ | tail -n 1 | awk '{print $3}' | sed s,\\.,, > $VERSION-release-data-plasma-workspace-wallpapers
perl -i -pe 'chomp if eof' $VERSION-release-data-plasma-workspace-wallpapers
mv plasma-workspace-wallpapers/ plasma-workspace-wallpapers-$VERSION
tar Jcf plasma-workspace-wallpapers-${VERSION}.tar.xz plasma-workspace-wallpapers-${VERSION}
echo >> $VERSION-release-data
echo -n "rev" >> $VERSION-release-data
cat $VERSION-release-data-plasma-workspace-wallpapers >> $VERSION-release-data
echo -n ";" >> $VERSION-release-data
sha256sum plasma-workspace-wallpapers-${VERSION}.tar.xz >> $VERSION-release-data
rm $VERSION-release-data-plasma-workspace-wallpapers

# tag plasma-workspace-wallpapers
# svn copy svn+ssh://svn@svn.kde.org/home/kde/trunk/KDE/plasma-workspace-wallpapers/ svn+ssh://svn@svn.kde.org/home/kde/tags/plasma-workspace-wallpapers/4.98.0 -m "Tagging 4.98.0 Plasma 5.0 RC"
