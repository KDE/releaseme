#!/bin/bash

. VERSIONS.inc

svn --version > /dev/null || { echo "Install subversion"; exit 1; }

mkdir $VERSION
cd $VERSION

WORKSPACE=`cat ../git-repositories-for-release`
echo "making tars for $WORKSPACE"
for project in $WORKSPACE; do
  echo ${project}
  ../../tarme.rb --origin ${ORIGIN} --version $VERSION ${project}
  cat release_data >> $VERSION-release-data
done

sed -i s,5.\d,${SHORT_VERSION}, ../projects/plasma-workspace-wallpapers-stable
../../tarme.rb --origin ${ORIGIN} --version ${VERSION} --from-config plasma-workspace-wallpapers-${ORIGIN}
# releaseme doesn't add release_data for svn currently
#cat release_data >> $VERSION-release-data

../create_sources_inc $VERSION > source-plasma-${VERSION}.inc
